local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")
local Player = Players.LocalPlayer

-- Create ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Parent = Player.PlayerGui
screenGui.Name = "TeleportGui"
screenGui.ResetOnSpawn = false -- GUI karakter ölünce kaybolmaz

-- Create Frame (GUI container)
local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 180, 0, 400)
frame.Position = UDim2.new(0.5, -90, 0.5, -200)
frame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
frame.BorderSizePixel = 2
frame.Parent = screenGui

-- Create Title Bar
local titleBar = Instance.new("Frame")
titleBar.Size = UDim2.new(1, 0, 0, 30)
titleBar.Position = UDim2.new(0, 0, 0, 0)
titleBar.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
titleBar.BorderSizePixel = 0
titleBar.Parent = frame

-- Create Title Text
local titleText = Instance.new("TextLabel")
titleText.Size = UDim2.new(0, 120, 1, 0)
titleText.Position = UDim2.new(0, 5, 0, 0)
titleText.BackgroundTransparency = 1
titleText.Text = "TROLL GUI BY Baris"
titleText.TextColor3 = Color3.fromRGB(255, 255, 255)
titleText.TextSize = 16
titleText.Font = Enum.Font.SourceSansBold
titleText.TextXAlignment = Enum.TextXAlignment.Left
titleText.Parent = titleBar

-- Create Close Button (X)
local closeButton = Instance.new("TextButton")
closeButton.Size = UDim2.new(0, 25, 0, 25)
closeButton.Position = UDim2.new(1, -30, 0, 2)
closeButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
closeButton.Text = "X"
closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
closeButton.TextSize = 16
closeButton.Font = Enum.Font.SourceSansBold
closeButton.Parent = titleBar
closeButton.MouseButton1Click:Connect(function()
    screenGui:Destroy()
end)

-- Create Minimize Button (-)
local minimizeButton = Instance.new("TextButton")
minimizeButton.Size = UDim2.new(0, 25, 0, 25)
minimizeButton.Position = UDim2.new(1, -60, 0, 2)
minimizeButton.BackgroundColor3 = Color3.fromRGB(255, 165, 0)
minimizeButton.Text = "-"
minimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
minimizeButton.TextSize = 16
minimizeButton.Font = Enum.Font.SourceSansBold
minimizeButton.Parent = titleBar

-- Create Content Frame (for buttons)
local contentFrame = Instance.new("Frame")
contentFrame.Size = UDim2.new(1, 0, 1, -30)
contentFrame.Position = UDim2.new(0, 0, 0, 30)
contentFrame.BackgroundTransparency = 1
contentFrame.Parent = frame

-- Smooth Dragging (Windows-like)
local dragging = false
local dragStart
local startPos

UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if not gameProcessed and input.UserInputType == Enum.UserInputType.MouseButton1 then
        local mousePos = input.Position
        local titlePos = titleBar.AbsolutePosition
        local titleSize = titleBar.AbsoluteSize
        if mousePos.X >= titlePos.X and mousePos.X <= titlePos.X + titleSize.X and
           mousePos.Y >= titlePos.Y and mousePos.Y <= titlePos.Y + titleSize.Y then
            dragging = true
            dragStart = mousePos
            startPos = frame.Position
        end
    end
end)

UserInputService.InputChanged:Connect(function(input, gameProcessed)
    if not gameProcessed and dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - dragStart
        frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

UserInputService.InputEnded:Connect(function(input, gameProcessed)
    if not gameProcessed and input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = false
    end
end)

-- Minimize Logic with Smooth Animation
local isMinimized = false
minimizeButton.MouseButton1Click:Connect(function()
    isMinimized = not isMinimized
    local targetSize = isMinimized and UDim2.new(0, 180, 0, 30) or UDim2.new(0, 180, 0, 400)
    local tweenInfo = TweenInfo.new(0.3, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut)
    local tween = TweenService:Create(frame, tweenInfo, {Size = targetSize})
    contentFrame.Visible = not isMinimized
    tween:Play()
end)

-- Create TROLL Button
local trollButton = Instance.new("TextButton")
trollButton.Size = UDim2.new(0, 160, 0, 40)
trollButton.Position = UDim2.new(0, 10, 0, 10)
trollButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
trollButton.Text = "TROLL: OFF"
trollButton.TextColor3 = Color3.fromRGB(255, 255, 255)
trollButton.TextSize = 14
trollButton.Font = Enum.Font.SourceSans
trollButton.TextScaled = true
trollButton.TextWrapped = true
trollButton.Parent = contentFrame

-- Create BUTTON TROLL Button
local buttonTrollButton = Instance.new("TextButton")
buttonTrollButton.Size = UDim2.new(0, 160, 0, 40)
buttonTrollButton.Position = UDim2.new(0, 10, 0, 60)
trollButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
buttonTrollButton.Text = "BUTTON TROLL: OFF"
buttonTrollButton.TextColor3 = Color3.fromRGB(255, 255, 255)
buttonTrollButton.TextSize = 14
buttonTrollButton.Font = Enum.Font.SourceSans
buttonTrollButton.TextScaled = true
buttonTrollButton.TextWrapped = true
buttonTrollButton.Parent = contentFrame

-- Create Goto End Button
local gotoEndButton = Instance.new("TextButton")
gotoEndButton.Size = UDim2.new(0, 160, 0, 40)
gotoEndButton.Position = UDim2.new(0, 10, 0, 110)
gotoEndButton.BackgroundColor3 = Color3.fromRGB(100, 100, 255)
gotoEndButton.Text = "Goto End"
gotoEndButton.TextColor3 = Color3.fromRGB(255, 255, 255)
gotoEndButton.TextSize = 14
gotoEndButton.Font = Enum.Font.SourceSans
gotoEndButton.TextScaled = true
gotoEndButton.TextWrapped = true
gotoEndButton.Parent = contentFrame

-- Create Goto Troll Zone Button
local gotoTrollZoneButton = Instance.new("TextButton")
gotoTrollZoneButton.Size = UDim2.new(0, 160, 0, 40)
gotoTrollZoneButton.Position = UDim2.new(0, 10, 0, 160)
gotoTrollZoneButton.BackgroundColor3 = Color3.fromRGB(100, 100, 255)
gotoTrollZoneButton.Text = "Goto Troll Zone"
gotoTrollZoneButton.TextColor3 = Color3.fromRGB(255, 255, 255)
gotoTrollZoneButton.TextSize = 14
gotoTrollZoneButton.Font = Enum.Font.SourceSans
gotoTrollZoneButton.TextScaled = true
gotoTrollZoneButton.TextWrapped = true
gotoTrollZoneButton.Parent = contentFrame

-- Create Coils Button
local coilsButton = Instance.new("TextButton")
coilsButton.Size = UDim2.new(0, 160, 0, 40)
coilsButton.Position = UDim2.new(0, 10, 0, 210)
coilsButton.BackgroundColor3 = Color3.fromRGB(100, 100, 255)
coilsButton.Text = "Coils"
coilsButton.TextColor3 = Color3.fromRGB(255, 255, 255)
coilsButton.TextSize = 14
coilsButton.Font = Enum.Font.SourceSans
coilsButton.TextScaled = true
coilsButton.TextWrapped = true
coilsButton.Parent = contentFrame

-- Create Rejoin Button
local rejoinButton = Instance.new("TextButton")
rejoinButton.Size = UDim2.new(0, 160, 0, 40)
rejoinButton.Position = UDim2.new(0, 10, 0, 260)
rejoinButton.BackgroundColor3 = Color3.fromRGB(100, 100, 255)
rejoinButton.Text = "Rejoin"
rejoinButton.TextColor3 = Color3.fromRGB(255, 255, 255)
rejoinButton.TextSize = 14
rejoinButton.Font = Enum.Font.SourceSans
rejoinButton.TextScaled = true
rejoinButton.TextWrapped = true
rejoinButton.Parent = contentFrame

-- Create Goto Other Server Button
local gotoOtherServerButton = Instance.new("TextButton")
gotoOtherServerButton.Size = UDim2.new(0, 160, 0, 40)
gotoOtherServerButton.Position = UDim2.new(0, 10, 0, 310)
gotoOtherServerButton.BackgroundColor3 = Color3.fromRGB(100, 100, 255)
gotoOtherServerButton.Text = "Goto Other Server"
gotoOtherServerButton.TextColor3 = Color3.fromRGB(255, 255, 255)
gotoOtherServerButton.TextSize = 14
gotoOtherServerButton.Font = Enum.Font.SourceSans
gotoOtherServerButton.TextScaled = true
gotoOtherServerButton.TextWrapped = true
gotoOtherServerButton.Parent = contentFrame

-- Global variables for auto teleport
_G.auto = false
_G.autoButtonTroll = false

-- TROLL Button Logic
local trollOn = false
trollButton.MouseButton1Click:Connect(function()
    trollOn = not trollOn
    if trollOn then
        trollButton.Text = "TROLL: ON"
        trollButton.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
        _G.auto = true
        spawn(function()
            while _G.auto do
                if Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
                    Player.Character.HumanoidRootPart.CFrame = CFrame.new(-78.2601929, 146.499817, -81.09935, -0.999982357, 0.0015448099, -0.00573654426, 1.18422931e-05, 0.966117144, 0.258104026, 0.00594089506, 0.258099407, -0.966100097)
                    wait(0.1)
                    if not _G.auto then return end
                    Player.Character.HumanoidRootPart.CFrame = CFrame.new(-45.6606674, 146.105118, -80.9601898, -0.999689102, 0.00459327316, -0.0245066043, -1.06306985e-09, 0.982884645, 0.184222117, 0.0249333475, 0.184164852, -0.982579052)
                    wait(0.05)
                    if not _G.auto then return end
                    Player.Character.HumanoidRootPart.CFrame = CFrame.new(-34.2864189, 146.64299, -82.5844727, -0.999138296, -0.00305992924, -0.0413918309, 0, 0.997278631, -0.0737247318, 0.0415047817, -0.0736612007, -0.996419251)
                    wait(0.003)
                    if not _G.auto then return end
                    Player.Character.HumanoidRootPart.CFrame = CFrame.new(-24.6313972, 146.640137, -82.3137207, -0.999952137, -0.000264210132, -0.00977986213, 7.25919672e-11, 0.999635279, -0.0270058867, 0.00978343002, -0.027004594, -0.999587417)
                    wait(0.0005)
                end
                wait()
            end
        end)
    else
        trollButton.Text = "TROLL: OFF"
        trollButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
        _G.auto = false
        spawn(function()
            while _G.auto do
                if Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
                    Player.Character.HumanoidRootPart.CFrame = CFrame.new(-78.2601929, 146.499817, -81.09935, -0.999982357, 0.0015448099, -0.00573654426, 1.18422931e-05, 0.966117144, 0.258104026, 0.00594089506, 0.258099407, -0.966100097)
                    wait(0.3)
                    if not _G.auto then return end
                    Player.Character.HumanoidRootPart.CFrame = CFrame.new(-45.6606674, 146.105118, -80.9601898, -0.999689102, 0.00459327316, -0.0245066043, -1.06306985e-09, 0.982884645, 0.184222117, 0.0249333475, 0.184164852, -0.982579052)
                    wait(0.25)
                    if not _G.auto then return end
                    Player.Character.HumanoidRootPart.CFrame = CFrame.new(-34.2864189, 146.64299, -82.5844727, -0.999138296, -0.00305992924, -0.0413918309, 0, 0.997278631, -0.0737247318, 0.0415047817, -0.0736612007, -0.996419251)
                    wait(0.15)
                    if not _G.auto then return end
                    Player.Character.HumanoidRootPart.CFrame = CFrame.new(-24.6313972, 146.640137, -82.3137207, -0.999952137, -0.000264210132, -0.00977986213, 7.25919672e-11, 0.999635279, -0.0270058867, 0.00978343002, -0.027004594, -0.999587417)
                    wait(0.05)
                end
                wait()
            end
            wait(0.42)
            if Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
                local targetPosition = Vector3.new(-67.91, 147.15, -81.44)
                Player.Character.HumanoidRootPart.CFrame = CFrame.new(targetPosition)
                print("Konuma ışınlandı!")
            else
                print("Karakter veya HumanoidRootPart bulunamadı!")
            end
        end)
    end
end)

-- BUTTON TROLL Button Logic
local buttonTrollOn = false
buttonTrollButton.MouseButton1Click:Connect(function()
    buttonTrollOn = not buttonTrollOn
    if buttonTrollOn then
        buttonTrollButton.Text = "BUTTON TROLL: ON"
        buttonTrollButton.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
        _G.autoButtonTroll = true
        spawn(function()
            while _G.autoButtonTroll do
                if Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
                    Player.Character.HumanoidRootPart.CFrame = CFrame.new(-78.6811523, 149.14035, -81.8744202, -0.999999881, 4.56550915e-05, 0.00052373379, 7.14497298e-12, 0.996222019, -0.0868429765, -0.000525719952, -0.0868429616, -0.9962219)
                    wait(0.01) -- Executor uyumluluğu için hafif gecikme
                end
                wait()
            end
        end)
    else
        buttonTrollButton.Text = "BUTTON TROLL: OFF"
        buttonTrollButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
        _G.autoButtonTroll = false
        spawn(function()
            while _G.autoButtonTroll do
                if Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
                    Player.Character.HumanoidRootPart.CFrame = CFrame.new(-78.2601929, 146.499817, -81.09935, -0.999982357, 0.0015448099, -0.00573654426, 1.18422931e-05, 0.966117144, 0.258104026, 0.00594089506, 0.258099407, -0.966100097)
                    wait(0.3)
                    if not _G.autoButtonTroll then return end
                    Player.Character.HumanoidRootPart.CFrame = CFrame.new(-45.6606674, 146.105118, -80.9601898, -0.999689102, 0.00459327316, -0.0245066043, -1.06306985e-09, 0.982884645, 0.184222117, 0.0249333475, 0.184164852, -0.982579052)
                    wait(0.25)
                    if not _G.autoButtonTroll then return end
                    Player.Character.HumanoidRootPart.CFrame = CFrame.new(-34.2864189, 146.64299, -82.5844727, -0.999138296, -0.00305992924, -0.0413918309, 0, 0.997278631, -0.0737247318, 0.0415047817, -0.0736612007, -0.996419251)
                    wait(0.15)
                    if not _G.autoButtonTroll then return end
                    Player.Character.HumanoidRootPart.CFrame = CFrame.new(-24.6313972, 146.640137, -82.3137207, -0.999952137, -0.000264210132, -0.00977986213, 7.25919672e-11, 0.999635279, -0.0270058867, 0.00978343002, -0.027004594, -0.999587417)
                    wait(0.05)
                end
                wait()
            end
            wait(0.42)
            if Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
                local targetPosition = Vector3.new(-67.91, 147.15, -81.44)
                Player.Character.HumanoidRootPart.CFrame = CFrame.new(targetPosition)
                print("Konuma ışınlandı!")
            else
                print("Karakter veya HumanoidRootPart bulunamadı!")
            end
        end)
    end
end)

-- Goto End Button Logic
gotoEndButton.MouseButton1Click:Connect(function()
    local success, errorMsg = pcall(function()
        if Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
            Player.Character.HumanoidRootPart.CFrame = CFrame.new(274.562683, 349.410706, -32.9934654, -0.0361356959, -1.16902875e-07, 0.999346912, -3.40690171e-12, 1, 1.16979152e-07, -0.999346912, 4.22371826e-09, -0.0361356959)
            print("Goto End konuma ışınlandı!")
        else
            error("Karakter veya HumanoidRootPart bulunamadı!")
        end
    end)
    if not success then
        warn("Goto End hatası: " .. tostring(errorMsg))
    end
end)

-- Goto Troll Zone Button Logic
gotoTrollZoneButton.MouseButton1Click:Connect(function()
    local success, errorMsg = pcall(function()
        if Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
            Player.Character.HumanoidRootPart.CFrame = CFrame.new(-69.7643051, 150.283585, -74.8606033, -0.0131014595, 4.37139285e-08, -0.999914169, 1.35947758e-13, 1, 4.37176801e-08, 0.999914169, 5.72629444e-10, -0.0131014595)
            print("Goto Troll Zone konuma ışınlandı!")
        else
            error("Karakter veya HumanoidRootPart bulunamadı!")
        end
    end)
    if not success then
        warn("Goto Troll Zone hatası: " .. tostring(errorMsg))
    end
end)

-- Coils Button Logic
coilsButton.MouseButton1Click:Connect(function()
    local success, errorMsg = pcall(function()
        if game.HttpGet then
            local script = game:HttpGet("https://rawscripts.net/raw/Troll-is-a-pinning-tower-2-Inf-Jump-Coil-Ice-Coil-35367")
            loadstring(script)()
            print("Coils scripti çalıştırıldı!")
        else
            error("HttpGet desteklenmiyor!")
        end
    end)
    if not success then
        warn("Coils scripti çalıştırılamadı: " .. tostring(errorMsg))
    end
end)

-- Rejoin Button Logic
rejoinButton.MouseButton1Click:Connect(function()
    local success, errorMsg = pcall(function()
        TeleportService:Teleport(game.PlaceId, Player)
    end)
    if not success then
        warn("Rejoin başarısız: " .. tostring(errorMsg))
    else
        print("Yeniden bağlanılıyor...")
    end
end)

-- Goto Other Server Button Logic
gotoOtherServerButton.MouseButton1Click:Connect(function()
    local success, errorMsg = pcall(function()
        local PlaceID = game.PlaceId
        local AllIDs = {}
        local foundAnything = ""
        local actualHour = os.date("!*t").hour

        local function TPReturner()
            local Site
            if foundAnything == "" then
                Site = HttpService:JSONDecode(game:HttpGet('https://games.roblox.com/v1/games/' .. PlaceID .. '/servers/Public?sortOrder=Asc&limit=100'))
            else
                Site = HttpService:JSONDecode(game:HttpGet('https://games.roblox.com/v1/games/' .. PlaceID .. '/servers/Public?sortOrder=Asc&limit=100&cursor=' .. foundAnything))
            end
            local ID = ""
            if Site.nextPageCursor and Site.nextPageCursor ~= "null" and Site.nextPageCursor ~= nil then
                foundAnything = Site.nextPageCursor
            end
            local num = 0
            for i, v in pairs(Site.data) do
                local Possible = true
                ID = tostring(v.id)
                if tonumber(v.maxPlayers) > tonumber(v.playing) then
                    for _, Existing in pairs(AllIDs) do
                        if num ~= 0 then
                            if ID == tostring(Existing) then
                                Possible = false
                            end
                        else
                            if tonumber(actualHour) ~= tonumber(Existing) then
                                AllIDs = {}
                                table.insert(AllIDs, actualHour)
                            end
                        end
                        num = num + 1
                    end
                    if Possible then
                        table.insert(AllIDs, ID)
                        wait()
                        local tpSuccess, tpError = pcall(function()
                            TeleportService:TeleportToPlaceInstance(PlaceID, ID, Player)
                        end)
                        if tpSuccess then
                            print("Diğer sunucuya ışınlandı!")
                        else
                            error("Teleport başarısız: " .. tostring(tpError))
                        end
                        wait(4)
                    end
                end
            end
        end

        local function Teleport()
            while wait() do
                local tpSuccess, tpError = pcall(function()
                    TPReturner()
                    if foundAnything ~= "" then
                        TPReturner()
                    end
                end)
                if not tpSuccess then
                    error("Server hop hata: " .. tostring(tpError))
                end
            end
        end

        spawn(function()
            Teleport()
        end)
    end)
    if not success then
        warn("Goto Other Server hatası: " .. tostring(errorMsg))
    end
end)
